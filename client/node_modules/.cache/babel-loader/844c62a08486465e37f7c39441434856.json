{"ast":null,"code":"import { geometry as geom, drawing as draw } from '@progress/kendo-drawing';\nimport { Class, defined, addClass, setDefaultOptions, deepExtend, getSpacing, isObject, defaultErrorHandler } from '../common';\nimport { Box, TextBox } from '../core';\nimport { Encodings } from './encodings/main';\nimport { surfaceSize } from './surface-size';\nvar DEFAULT_BARCODE_WIDTH = 300;\nvar DEFAULT_BARCODE_HEIGHT = 100;\n\nvar Barcode = function (Class) {\n  function Barcode(element, options, errorHandler) {\n    if (errorHandler === void 0) errorHandler = defaultErrorHandler;\n    Class.call(this);\n    this.options = deepExtend({}, this.options, options);\n    this.element = element;\n    this.onError = errorHandler;\n\n    this._initElement();\n\n    this._initSurface();\n\n    this._setOptions(options);\n\n    if (options && defined(options.value)) {\n      this.redraw();\n    }\n  }\n\n  if (Class) Barcode.__proto__ = Class;\n  Barcode.prototype = Object.create(Class && Class.prototype);\n  Barcode.prototype.constructor = Barcode;\n\n  Barcode.prototype.destroy = function destroy() {\n    this._destroySurface();\n  };\n\n  Barcode.prototype._initElement = function _initElement() {\n    addClass(this.element, \"k-barcode\");\n  };\n\n  Barcode.prototype._initSurface = function _initSurface() {\n    var ref = this;\n    var options = ref.options;\n    var surface = ref.surface;\n\n    if (!surface || surface.options.type !== options.renderAs) {\n      this._destroySurface();\n\n      this._initSurfaceElement();\n\n      this.surface = this._createSurface();\n    }\n  };\n\n  Barcode.prototype._createSurface = function _createSurface() {\n    return draw.Surface.create(this.surfaceElement, {\n      type: this.options.renderAs\n    });\n  };\n\n  Barcode.prototype._destroySurface = function _destroySurface() {\n    if (this.surface) {\n      this.surface.destroy();\n      this.surface = null;\n\n      this._destroySurfaceElement();\n    }\n  };\n\n  Barcode.prototype._initSurfaceElement = function _initSurfaceElement() {\n    if (!this.surfaceElement) {\n      this.surfaceElement = document.createElement('div');\n      this.surfaceElement.style.position = 'relative';\n      this.element.appendChild(this.surfaceElement);\n    }\n  };\n\n  Barcode.prototype._destroySurfaceElement = function _destroySurfaceElement() {\n    if (this.surfaceElement && this.surfaceElement.parentNode) {\n      this.surfaceElement.parentNode.removeChild(this.surfaceElement);\n      this.surfaceElement = null;\n    }\n  };\n\n  Barcode.prototype.setOptions = function setOptions(options) {\n    this._setOptions(options);\n\n    this._initSurface();\n\n    this.redraw();\n  };\n\n  Barcode.prototype.redraw = function redraw() {\n    var size = this._getSize();\n\n    this.surface.clear();\n    this.surface.setSize({\n      width: size.width,\n      height: size.height\n    });\n    this.createVisual();\n    this.surface.draw(this.visual);\n  };\n\n  Barcode.prototype.getSize = function getSize() {\n    return {\n      width: this.element.offsetWidth,\n      height: this.element.offsetHeight\n    };\n  };\n\n  Barcode.prototype._resize = function _resize() {\n    this.redraw();\n  };\n\n  Barcode.prototype.createVisual = function createVisual() {\n    this.visual = this._render();\n  };\n\n  Barcode.prototype._render = function _render() {\n    var options = this.options;\n    var value = options.value;\n    var textOptions = options.text;\n    var textMargin = getSpacing(textOptions.margin);\n\n    var size = this._getSize();\n\n    var border = options.border || {};\n    var encoding = this.encoding;\n    var contentBox = new Box(0, 0, size.width, size.height).unpad(border.width).unpad(options.padding);\n    var barHeight = contentBox.height();\n    var encodedValue;\n    var textToDisplay;\n    var textHeight;\n    var visual = new draw.Group();\n    this.contentBox = contentBox;\n    visual.append(this._getBackground(size));\n\n    if (textOptions.visible) {\n      textHeight = draw.util.measureText(value, {\n        font: textOptions.font\n      }).height;\n      barHeight -= textHeight + textMargin.top + textMargin.bottom;\n    }\n\n    try {\n      encodedValue = encoding.encode(value, contentBox.width(), barHeight);\n    } catch (error) {\n      this.onError(error);\n      return visual;\n    }\n\n    if (textOptions.visible) {\n      textToDisplay = value;\n\n      if (options.checksum && defined(encoding.checksum)) {\n        textToDisplay += \" \" + encoding.checksum;\n      }\n\n      visual.append(this._getText(textToDisplay));\n    }\n\n    this.barHeight = barHeight;\n    this._bandsGroup = this._getBands(encodedValue.pattern, encodedValue.baseUnit);\n    visual.append(this._bandsGroup);\n    return visual;\n  };\n\n  Barcode.prototype.exportVisual = function exportVisual() {\n    return this._render();\n  };\n\n  Barcode.prototype._getSize = function _getSize() {\n    var element = this.element;\n    var elementSize = surfaceSize(element, this.options.renderAs);\n    var size = new geom.Size(DEFAULT_BARCODE_WIDTH, DEFAULT_BARCODE_HEIGHT);\n\n    if (elementSize.width > 0) {\n      size.width = elementSize.width;\n    }\n\n    if (elementSize.height > 0) {\n      size.height = elementSize.height;\n    }\n\n    if (this.options.width) {\n      size.width = this.options.width;\n    }\n\n    if (this.options.height) {\n      size.height = this.options.height;\n    }\n\n    return size;\n  };\n\n  Barcode.prototype.value = function value(value$1) {\n    if (!defined(value$1)) {\n      return this.options.value;\n    }\n\n    this.options.value = String(value$1);\n    this.redraw();\n  };\n\n  Barcode.prototype._getBands = function _getBands(pattern, baseUnit) {\n    var this$1 = this;\n    var contentBox = this.contentBox;\n    var offsetX = contentBox.x1;\n    var stepX;\n    var patternItem;\n    var group = new draw.Group();\n\n    for (var i = 0; i < pattern.length; i++) {\n      patternItem = isObject(pattern[i]) ? pattern[i] : {\n        width: pattern[i],\n        y1: 0,\n        y2: this$1.barHeight\n      };\n      stepX = patternItem.width * baseUnit;\n\n      if (i % 2) {\n        var rect = geom.Rect.fromPoints(new geom.Point(offsetX, patternItem.y1 + contentBox.y1), new geom.Point(offsetX + stepX, patternItem.y2 + contentBox.y1));\n        var path = draw.Path.fromRect(rect, {\n          fill: {\n            color: this$1.options.color\n          },\n          stroke: null\n        });\n        group.append(path);\n      }\n\n      offsetX += stepX;\n    }\n\n    return group;\n  };\n\n  Barcode.prototype._getBackground = function _getBackground(size) {\n    var options = this.options;\n    var border = options.border || {};\n    var box = new Box(0, 0, size.width, size.height).unpad(border.width / 2);\n    var path = draw.Path.fromRect(box.toRect(), {\n      fill: {\n        color: options.background\n      },\n      stroke: {\n        color: border.width ? border.color : \"\",\n        width: border.width,\n        dashType: border.dashType\n      }\n    });\n    return path;\n  };\n\n  Barcode.prototype._getText = function _getText(value) {\n    var textOptions = this.options.text;\n    var text = this._textbox = new TextBox(value, {\n      font: textOptions.font,\n      color: textOptions.color,\n      align: \"center\",\n      vAlign: \"bottom\",\n      margin: textOptions.margin\n    });\n    text.reflow(this.contentBox);\n    text.renderVisual();\n    return text.visual;\n  };\n\n  Barcode.prototype._setOptions = function _setOptions(options) {\n    this.type = (options.type || this.options.type).toLowerCase();\n\n    if (this.type === \"upca\") {\n      this.type = \"ean13\";\n      options.value = '0' + options.value;\n    }\n\n    if (this.type === \"upce\") {\n      this.type = \"ean8\";\n      options.value = '0' + options.value;\n    }\n\n    if (!Encodings[this.type]) {\n      throw new Error(\"Encoding '\" + this.type + \"' is not supported.\");\n    }\n\n    this.encoding = new Encodings[this.type]();\n    this.options = deepExtend({}, this.options, options);\n  };\n\n  return Barcode;\n}(Class);\n\nsetDefaultOptions(Barcode, {\n  name: \"Barcode\",\n  renderAs: \"svg\",\n  value: \"\",\n  type: \"code39\",\n  checksum: false,\n  width: 0,\n  height: 0,\n  color: \"black\",\n  background: \"white\",\n  text: {\n    visible: true,\n    font: \"16px Consolas, Monaco, Sans Mono, monospace, sans-serif\",\n    color: \"black\",\n    margin: {\n      top: 0,\n      bottom: 0,\n      left: 0,\n      right: 0\n    }\n  },\n  border: {\n    width: 0,\n    dashType: \"solid\",\n    color: \"black\"\n  },\n  padding: {\n    top: 0,\n    bottom: 0,\n    left: 0,\n    right: 0\n  }\n});\nexport default Barcode;","map":{"version":3,"sources":["/home/meryem/repos/Movie_Trend_Visualizer/client/node_modules/@progress/kendo-charts/dist/es/barcode/barcode.js"],"names":["geometry","geom","drawing","draw","Class","defined","addClass","setDefaultOptions","deepExtend","getSpacing","isObject","defaultErrorHandler","Box","TextBox","Encodings","surfaceSize","DEFAULT_BARCODE_WIDTH","DEFAULT_BARCODE_HEIGHT","Barcode","element","options","errorHandler","call","onError","_initElement","_initSurface","_setOptions","value","redraw","__proto__","prototype","Object","create","constructor","destroy","_destroySurface","ref","surface","type","renderAs","_initSurfaceElement","_createSurface","Surface","surfaceElement","_destroySurfaceElement","document","createElement","style","position","appendChild","parentNode","removeChild","setOptions","size","_getSize","clear","setSize","width","height","createVisual","visual","getSize","offsetWidth","offsetHeight","_resize","_render","textOptions","text","textMargin","margin","border","encoding","contentBox","unpad","padding","barHeight","encodedValue","textToDisplay","textHeight","Group","append","_getBackground","visible","util","measureText","font","top","bottom","encode","error","checksum","_getText","_bandsGroup","_getBands","pattern","baseUnit","exportVisual","elementSize","Size","value$1","String","this$1","offsetX","x1","stepX","patternItem","group","i","length","y1","y2","rect","Rect","fromPoints","Point","path","Path","fromRect","fill","color","stroke","box","toRect","background","dashType","_textbox","align","vAlign","reflow","renderVisual","toLowerCase","Error","name","left","right"],"mappings":"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","sourcesContent":["import {\n    geometry as geom,\n    drawing as draw\n} from '@progress/kendo-drawing';\n\nimport {\n    Class,\n    defined,\n    addClass,\n    setDefaultOptions,\n    deepExtend,\n    getSpacing,\n    isObject,\n    defaultErrorHandler\n} from '../common';\n\nimport {\n    Box,\n    TextBox\n} from '../core';\n\nimport { Encodings } from './encodings/main';\nimport { surfaceSize } from './surface-size';\n\nvar DEFAULT_BARCODE_WIDTH = 300;\nvar DEFAULT_BARCODE_HEIGHT = 100;\n\nvar Barcode = (function (Class) {\n    function Barcode(element, options, errorHandler) {\n        if ( errorHandler === void 0 ) errorHandler = defaultErrorHandler;\n\n        Class.call(this);\n\n        this.options = deepExtend({}, this.options, options);\n        this.element = element;\n        this.onError = errorHandler;\n\n        this._initElement();\n        this._initSurface();\n        this._setOptions(options);\n\n        if (options && defined(options.value)) {\n            this.redraw();\n        }\n    }\n\n    if ( Class ) Barcode.__proto__ = Class;\n    Barcode.prototype = Object.create( Class && Class.prototype );\n    Barcode.prototype.constructor = Barcode;\n\n    Barcode.prototype.destroy = function destroy () {\n        this._destroySurface();\n    };\n\n    Barcode.prototype._initElement = function _initElement () {\n        addClass(this.element, \"k-barcode\");\n    };\n\n    Barcode.prototype._initSurface = function _initSurface () {\n        var ref = this;\n        var options = ref.options;\n        var surface = ref.surface;\n\n        if (!surface || surface.options.type !== options.renderAs) {\n            this._destroySurface();\n            this._initSurfaceElement();\n            this.surface = this._createSurface();\n        }\n    };\n\n    Barcode.prototype._createSurface = function _createSurface () {\n        return draw.Surface.create(this.surfaceElement, {\n            type: this.options.renderAs\n        });\n    };\n\n    Barcode.prototype._destroySurface = function _destroySurface () {\n        if (this.surface) {\n            this.surface.destroy();\n            this.surface = null;\n            this._destroySurfaceElement();\n        }\n    };\n\n    Barcode.prototype._initSurfaceElement = function _initSurfaceElement () {\n        if (!this.surfaceElement) {\n            this.surfaceElement = document.createElement('div');\n            this.surfaceElement.style.position = 'relative';\n            this.element.appendChild(this.surfaceElement);\n        }\n    };\n\n    Barcode.prototype._destroySurfaceElement = function _destroySurfaceElement () {\n        if (this.surfaceElement && this.surfaceElement.parentNode) {\n            this.surfaceElement.parentNode.removeChild(this.surfaceElement);\n            this.surfaceElement = null;\n        }\n    };\n\n    Barcode.prototype.setOptions = function setOptions (options) {\n        this._setOptions(options);\n        this._initSurface();\n        this.redraw();\n    };\n\n    Barcode.prototype.redraw = function redraw () {\n        var size = this._getSize();\n\n        this.surface.clear();\n\n        this.surface.setSize({\n            width: size.width,\n            height: size.height\n        });\n\n        this.createVisual();\n\n        this.surface.draw(this.visual);\n    };\n\n    Barcode.prototype.getSize = function getSize () {\n        return {\n            width: this.element.offsetWidth,\n            height: this.element.offsetHeight\n        };\n    };\n\n    Barcode.prototype._resize = function _resize () {\n        this.redraw();\n    };\n\n    Barcode.prototype.createVisual = function createVisual () {\n        this.visual = this._render();\n    };\n\n    Barcode.prototype._render = function _render () {\n        var options = this.options;\n        var value = options.value;\n        var textOptions = options.text;\n        var textMargin = getSpacing(textOptions.margin);\n        var size = this._getSize();\n        var border = options.border || {};\n        var encoding = this.encoding;\n        var contentBox = new Box(0, 0, size.width, size.height).unpad(border.width).unpad(options.padding);\n        var barHeight = contentBox.height();\n        var encodedValue;\n        var textToDisplay;\n        var textHeight;\n        var visual = new draw.Group();\n\n        this.contentBox = contentBox;\n        visual.append(this._getBackground(size));\n\n        if (textOptions.visible) {\n            textHeight = draw.util.measureText(value, { font: textOptions.font }).height;\n            barHeight -= textHeight + textMargin.top + textMargin.bottom;\n        }\n\n        try {\n            encodedValue = encoding.encode(value, contentBox.width(), barHeight);\n        } catch (error) {\n            this.onError(error);\n            return visual;\n        }\n\n        if (textOptions.visible) {\n            textToDisplay = value;\n\n            if (options.checksum && defined(encoding.checksum)) {\n                textToDisplay += \" \" + encoding.checksum;\n            }\n\n            visual.append(this._getText(textToDisplay));\n        }\n\n        this.barHeight = barHeight;\n        this._bandsGroup = this._getBands(encodedValue.pattern, encodedValue.baseUnit);\n        visual.append(this._bandsGroup);\n\n        return visual;\n    };\n\n    Barcode.prototype.exportVisual = function exportVisual () {\n        return this._render();\n    };\n\n    Barcode.prototype._getSize = function _getSize () {\n        var element = this.element;\n        var elementSize = surfaceSize(element, this.options.renderAs);\n        var size = new geom.Size(DEFAULT_BARCODE_WIDTH, DEFAULT_BARCODE_HEIGHT);\n\n        if (elementSize.width > 0) {\n            size.width = elementSize.width;\n        }\n\n        if (elementSize.height > 0) {\n            size.height = elementSize.height;\n        }\n\n        if (this.options.width) {\n            size.width = this.options.width;\n        }\n\n        if (this.options.height) {\n            size.height = this.options.height;\n        }\n\n        return size;\n    };\n\n    Barcode.prototype.value = function value (value$1) {\n        if (!defined(value$1)) {\n            return this.options.value;\n        }\n\n        this.options.value = String(value$1);\n        this.redraw();\n    };\n\n    Barcode.prototype._getBands = function _getBands (pattern, baseUnit) {\n        var this$1 = this;\n\n        var contentBox = this.contentBox;\n        var offsetX = contentBox.x1;\n        var stepX;\n        var patternItem;\n        var group = new draw.Group();\n\n        for (var i = 0; i < pattern.length; i++) {\n            patternItem = isObject(pattern[i]) ? pattern[i] : {\n                width: pattern[i],\n                y1: 0,\n                y2: this$1.barHeight\n            };\n\n            stepX = patternItem.width * baseUnit;\n\n            if (i % 2) {\n                var rect = geom.Rect.fromPoints(\n                    new geom.Point(offsetX, patternItem.y1 + contentBox.y1),\n                    new geom.Point(offsetX + stepX, patternItem.y2 + contentBox.y1)\n                );\n\n                var path = draw.Path.fromRect(rect, {\n                    fill: {\n                        color: this$1.options.color\n                    },\n                    stroke: null\n                });\n\n                group.append(path);\n            }\n\n            offsetX += stepX;\n        }\n\n        return group;\n    };\n\n    Barcode.prototype._getBackground = function _getBackground (size) {\n        var options = this.options;\n        var border = options.border || {};\n        var box = new Box(0, 0, size.width, size.height).unpad(border.width / 2);\n        var path = draw.Path.fromRect(box.toRect(), {\n            fill: {\n                color: options.background\n            },\n            stroke: {\n                color: border.width ? border.color : \"\",\n                width: border.width,\n                dashType: border.dashType\n            }\n        });\n\n        return path;\n    };\n\n    Barcode.prototype._getText = function _getText (value) {\n        var textOptions = this.options.text;\n        var text = this._textbox = new TextBox(value, {\n            font: textOptions.font,\n            color: textOptions.color,\n            align: \"center\",\n            vAlign: \"bottom\",\n            margin: textOptions.margin\n        });\n\n        text.reflow(this.contentBox);\n        text.renderVisual();\n\n        return text.visual;\n    };\n\n    Barcode.prototype._setOptions = function _setOptions (options) {\n        this.type = (options.type || this.options.type).toLowerCase();\n\n        if (this.type === \"upca\") {\n            this.type = \"ean13\";\n            options.value = '0' + options.value;\n        }\n\n        if (this.type === \"upce\") {\n            this.type = \"ean8\";\n            options.value = '0' + options.value;\n        }\n\n        if (!Encodings[this.type]) {\n            throw new Error((\"Encoding '\" + (this.type) + \"' is not supported.\"));\n        }\n\n        this.encoding = new Encodings[this.type]();\n\n        this.options = deepExtend({}, this.options, options);\n    };\n\n    return Barcode;\n}(Class));\n\nsetDefaultOptions(Barcode, {\n    name: \"Barcode\",\n    renderAs: \"svg\",\n    value: \"\",\n    type: \"code39\",\n    checksum: false,\n    width: 0,\n    height: 0,\n    color: \"black\",\n    background: \"white\",\n    text: {\n        visible: true,\n        font: \"16px Consolas, Monaco, Sans Mono, monospace, sans-serif\",\n        color: \"black\",\n        margin: {\n            top: 0,\n            bottom: 0,\n            left: 0,\n            right: 0\n        }\n    },\n    border: {\n        width: 0,\n        dashType: \"solid\",\n        color: \"black\"\n    },\n    padding: {\n        top: 0,\n        bottom: 0,\n        left: 0,\n        right: 0\n    }\n});\n\nexport default Barcode;\n"]},"metadata":{},"sourceType":"module"}
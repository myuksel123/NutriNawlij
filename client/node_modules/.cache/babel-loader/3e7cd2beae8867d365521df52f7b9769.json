{"ast":null,"code":"import { Class, addClass, isArray, getter, deepExtend, setDefaultOptions } from '../../common';\nimport { Layer } from './layer';\nimport { Location } from '../location';\nimport { proxy, on, off, toHyphens, toPixels } from '../utils';\nvar CLICK = \"click\";\nvar MOUSE_ENTER = \"mouseenter\";\nvar MOUSE_LEAVE = \"mouseleave\";\nvar extend = Object.assign;\nvar MARKER_CLASS = \".k-marker\";\nexport var MarkerLayer = function (Layer) {\n  function MarkerLayer(map, options) {\n    Layer.call(this, map, options);\n    this._markerClickHandler = proxy(this._markerClick, this);\n    on(this.element, CLICK, MARKER_CLASS, this._markerClickHandler);\n    this.items = [];\n\n    this._load(this._readData());\n  }\n\n  if (Layer) MarkerLayer.__proto__ = Layer;\n  MarkerLayer.prototype = Object.create(Layer && Layer.prototype);\n  MarkerLayer.prototype.constructor = MarkerLayer;\n\n  MarkerLayer.prototype.destroy = function destroy() {\n    Layer.prototype.destroy.call(this);\n    off(this.element, CLICK, this._markerClickHandler);\n    this.clear();\n  };\n\n  MarkerLayer.prototype.add = function add(args) {\n    var this$1 = this;\n\n    if (isArray(args)) {\n      for (var i = 0; i < args.length; i++) {\n        this$1._addOne(args[i]);\n      }\n    } else {\n      return this._addOne(args);\n    }\n  };\n\n  MarkerLayer.prototype.remove = function remove(marker) {\n    marker.destroy();\n    var index = (this.items || []).indexOf(marker);\n\n    if (index > -1) {\n      this.items.splice(index, 1);\n    }\n  };\n\n  MarkerLayer.prototype.clear = function clear() {\n    var this$1 = this;\n\n    for (var i = 0; i < this.items.length; i++) {\n      this$1.items[i].destroy();\n    }\n\n    this.items = [];\n  };\n\n  MarkerLayer.prototype.update = function update(marker) {\n    var location = marker.location();\n\n    if (location) {\n      marker.showAt(this.map.locationToView(location));\n      var args = {\n        marker: marker,\n        layer: this\n      };\n      this.map.trigger('markerActivate', args);\n    }\n  };\n\n  MarkerLayer.prototype._reset = function _reset() {\n    var this$1 = this;\n\n    Layer.prototype._reset.call(this);\n\n    var items = this.items;\n\n    for (var i = 0; i < items.length; i++) {\n      this$1.update(items[i]);\n    }\n  };\n\n  MarkerLayer.prototype.bind = function bind(options, dataItem) {\n    var marker = Marker.create(options, this.options);\n    marker.dataItem = dataItem;\n    var args = {\n      marker: marker,\n      layer: this\n    };\n    var cancelled = this.map.trigger('markerCreated', args);\n\n    if (!cancelled) {\n      this.add(marker);\n      return marker;\n    }\n  };\n\n  MarkerLayer.prototype._addOne = function _addOne(arg) {\n    var marker = Marker.create(arg, this.options);\n    marker.addTo(this);\n    return marker;\n  };\n\n  MarkerLayer.prototype._readData = function _readData() {\n    var data = this.options.data || [];\n    return data;\n  };\n\n  MarkerLayer.prototype._load = function _load(data) {\n    var this$1 = this;\n    this._data = data;\n    this.clear();\n    var getLocation = getter(this.options.locationField);\n    var getTitle = getter(this.options.titleField);\n\n    for (var i = 0; i < data.length; i++) {\n      var dataItem = data[i];\n      this$1.bind({\n        location: getLocation(dataItem),\n        title: getTitle(dataItem)\n      }, dataItem);\n    }\n  };\n\n  MarkerLayer.prototype._markerClick = function _markerClick(e) {\n    var layers = this.map.layers || [];\n    var marker = e.target._kendoNode;\n    var args = {\n      // marker: $(e.target).data('kendoMarker'),\n      // marker: e.target.getAttribute(\"data-kendoMarker\"),\n      layer: this,\n      layerIndex: layers.indexOf(this),\n      marker: marker,\n      markerIndex: (this.items || []).indexOf(marker),\n      originalEvent: e\n    };\n    this.map.trigger('markerClick', args);\n  };\n\n  MarkerLayer.prototype._markerMouseEnter = function _markerMouseEnter(e) {\n    var args = this._createMarkerEventArgs(e);\n\n    this.map.trigger(\"markerMouseEnter\", args);\n  };\n\n  MarkerLayer.prototype._markerMouseLeave = function _markerMouseLeave(e) {\n    var args = this._createMarkerEventArgs(e);\n\n    this.map.trigger(\"markerMouseLeave\", args);\n  };\n\n  MarkerLayer.prototype._createMarkerEventArgs = function _createMarkerEventArgs(e) {\n    var marker = e.marker;\n    var args = extend({}, {\n      layer: this,\n      layerIndex: this.map.layers.indexOf(this),\n      marker: marker,\n      markerIndex: (this.items || []).indexOf(marker)\n    }, e);\n    return args;\n  };\n\n  return MarkerLayer;\n}(Layer);\nsetDefaultOptions(MarkerLayer, {\n  zIndex: 1000,\n  autoBind: true,\n  locationField: 'location',\n  titleField: 'title'\n});\nexport var Marker = function (Class) {\n  function Marker(options) {\n    Class.call(this);\n    this.options = options || {};\n  }\n\n  if (Class) Marker.__proto__ = Class;\n  Marker.prototype = Object.create(Class && Class.prototype);\n  Marker.prototype.constructor = Marker;\n\n  Marker.prototype.destroy = function destroy() {\n    this.layer = null;\n    this.unbindEvents();\n    this.hide();\n  };\n\n  Marker.prototype.addTo = function addTo(parent) {\n    this.layer = parent.markers || parent;\n    this.layer.items.push(this);\n    this.layer.update(this);\n  };\n\n  Marker.prototype.location = function location(value) {\n    if (value) {\n      this.options.location = Location.create(value).toArray();\n\n      if (this.layer) {\n        this.layer.update(this);\n      }\n\n      return this;\n    }\n\n    return Location.create(this.options.location);\n  };\n\n  Marker.prototype.showAt = function showAt(point) {\n    this.render();\n    this.element.style.left = toPixels(Math.round(point.x));\n    this.element.style.top = toPixels(Math.round(point.y));\n\n    if (this.tooltip && this.tooltip.popup) {\n      this.tooltip.popup._position();\n    }\n  };\n\n  Marker.prototype.hide = function hide() {\n    if (this.element) {\n      this.element.remove();\n      this.element = null;\n    }\n\n    if (this.tooltip) {\n      this.tooltip.destroy();\n      this.tooltip = null;\n    }\n  };\n\n  Marker.prototype.bindEvents = function bindEvents() {\n    if (!this.element) {\n      return;\n    }\n\n    this._mouseEnterHandler = proxy(this._mouseEnter, this);\n    on(this.element, MOUSE_ENTER, MARKER_CLASS, this._mouseEnterHandler);\n    this._mouseLeaveHandler = proxy(this._mouseLeave, this);\n    on(this.element, MOUSE_LEAVE, MARKER_CLASS, this._mouseLeaveHandler);\n  };\n\n  Marker.prototype.unbindEvents = function unbindEvents() {\n    if (!this.element) {\n      return;\n    }\n\n    off(this.element, MOUSE_ENTER, this._mouseEnterHandler);\n    off(this.element, MOUSE_LEAVE, this._mouseLeaveHandler);\n  };\n\n  Marker.prototype.render = function render() {\n    if (!this.element) {\n      var options = this.options;\n      var layer = this.layer;\n      var element = document.createElement('span');\n      addClass(element, 'k-marker k-icon k-i-marker-' + toHyphens(options.shape || 'pin'));\n      element.setAttribute(\"title\", options.title);\n      var attributes = options.attributes || {};\n      Object.keys(attributes).forEach(function (key) {\n        element.setAttributett(key, attributes[key]);\n      });\n      element._kendoNode = this;\n      element.style.zIndex = options.zIndex;\n      this.element = element;\n\n      if (layer) {\n        layer.element.appendChild(this.element);\n      }\n\n      this.bindEvents();\n      this.renderTooltip();\n    }\n  };\n\n  Marker.prototype._mouseEnter = function _mouseEnter(e) {\n    var args = this._createEventArgs(e);\n\n    this.layer._markerMouseEnter(args);\n  };\n\n  Marker.prototype._mouseLeave = function _mouseLeave(e) {\n    var args = this._createEventArgs(e);\n\n    this.layer._markerMouseLeave(args);\n  };\n\n  Marker.prototype._createEventArgs = function _createEventArgs(e) {\n    var args = {\n      marker: this,\n      originalEvent: e\n    };\n    return args;\n  };\n\n  Marker.prototype.renderTooltip = function renderTooltip() {};\n\n  Marker.create = function create(arg, defaults) {\n    if (arg instanceof Marker) {\n      return arg;\n    }\n\n    return new Marker(deepExtend({}, defaults, arg));\n  };\n\n  return Marker;\n}(Class);","map":{"version":3,"sources":["/home/meryem/repos/Movie_Trend_Visualizer/client/node_modules/@progress/kendo-charts/dist/es/map/layers/marker.js"],"names":["Class","addClass","isArray","getter","deepExtend","setDefaultOptions","Layer","Location","proxy","on","off","toHyphens","toPixels","CLICK","MOUSE_ENTER","MOUSE_LEAVE","extend","Object","assign","MARKER_CLASS","MarkerLayer","map","options","call","_markerClickHandler","_markerClick","element","items","_load","_readData","__proto__","prototype","create","constructor","destroy","clear","add","args","this$1","i","length","_addOne","remove","marker","index","indexOf","splice","update","location","showAt","locationToView","layer","trigger","_reset","bind","dataItem","Marker","cancelled","arg","addTo","data","_data","getLocation","locationField","getTitle","titleField","title","e","layers","target","_kendoNode","layerIndex","markerIndex","originalEvent","_markerMouseEnter","_createMarkerEventArgs","_markerMouseLeave","zIndex","autoBind","unbindEvents","hide","parent","markers","push","value","toArray","point","render","style","left","Math","round","x","top","y","tooltip","popup","_position","bindEvents","_mouseEnterHandler","_mouseEnter","_mouseLeaveHandler","_mouseLeave","document","createElement","shape","setAttribute","attributes","keys","forEach","key","setAttributett","appendChild","renderTooltip","_createEventArgs","defaults"],"mappings":"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","sourcesContent":["import {\n    Class,\n    addClass,\n    isArray,\n    getter,\n    deepExtend,\n    setDefaultOptions\n} from '../../common';\n\nimport { Layer } from './layer';\nimport { Location } from '../location';\n\nimport {\n    proxy,\n    on,\n    off,\n    toHyphens,\n    toPixels\n} from '../utils';\n\nvar CLICK = \"click\";\nvar MOUSE_ENTER = \"mouseenter\";\nvar MOUSE_LEAVE = \"mouseleave\";\n\nvar extend = Object.assign;\nvar MARKER_CLASS = \".k-marker\";\n\nexport var MarkerLayer = (function (Layer) {\n    function MarkerLayer(map, options) {\n        Layer.call(this, map, options);\n\n        this._markerClickHandler = proxy(this._markerClick, this);\n        on(this.element, CLICK, MARKER_CLASS, this._markerClickHandler);\n\n        this.items = [];\n\n        this._load(this._readData());\n    }\n\n    if ( Layer ) MarkerLayer.__proto__ = Layer;\n    MarkerLayer.prototype = Object.create( Layer && Layer.prototype );\n    MarkerLayer.prototype.constructor = MarkerLayer;\n\n    MarkerLayer.prototype.destroy = function destroy () {\n        Layer.prototype.destroy.call(this);\n        off(this.element, CLICK, this._markerClickHandler);\n        this.clear();\n    };\n\n    MarkerLayer.prototype.add = function add (args) {\n        var this$1 = this;\n\n        if (isArray(args)) {\n            for (var i = 0; i < args.length; i++) {\n                this$1._addOne(args[i]);\n            }\n        } else {\n            return this._addOne(args);\n        }\n    };\n\n    MarkerLayer.prototype.remove = function remove (marker) {\n        marker.destroy();\n        var index = (this.items || []).indexOf(marker);\n\n        if (index > -1) {\n            this.items.splice(index, 1);\n        }\n    };\n\n    MarkerLayer.prototype.clear = function clear () {\n        var this$1 = this;\n\n        for (var i = 0; i < this.items.length; i++) {\n            this$1.items[i].destroy();\n        }\n\n        this.items = [];\n    };\n\n    MarkerLayer.prototype.update = function update (marker) {\n        var location = marker.location();\n\n        if (location) {\n            marker.showAt(this.map.locationToView(location));\n\n            var args = {\n                marker: marker,\n                layer: this\n            };\n\n            this.map.trigger('markerActivate', args);\n        }\n    };\n\n    MarkerLayer.prototype._reset = function _reset () {\n        var this$1 = this;\n\n        Layer.prototype._reset.call(this);\n\n        var items = this.items;\n\n        for (var i = 0; i < items.length; i++) {\n            this$1.update(items[i]);\n        }\n    };\n\n    MarkerLayer.prototype.bind = function bind (options, dataItem) {\n        var marker = Marker.create(options, this.options);\n        marker.dataItem = dataItem;\n\n        var args = {\n            marker: marker,\n            layer: this\n        };\n\n        var cancelled = this.map.trigger('markerCreated', args);\n\n        if (!cancelled) {\n            this.add(marker);\n            return marker;\n        }\n    };\n\n    MarkerLayer.prototype._addOne = function _addOne (arg) {\n        var marker = Marker.create(arg, this.options);\n        marker.addTo(this);\n        return marker;\n    };\n\n    MarkerLayer.prototype._readData = function _readData () {\n        var data = this.options.data || [];\n        return data;\n    };\n\n    MarkerLayer.prototype._load = function _load (data) {\n        var this$1 = this;\n\n        this._data = data;\n        this.clear();\n\n        var getLocation = getter(this.options.locationField);\n        var getTitle = getter(this.options.titleField);\n\n        for (var i = 0; i < data.length; i++) {\n            var dataItem = data[i];\n\n            this$1.bind({\n                location: getLocation(dataItem),\n                title: getTitle(dataItem)\n            }, dataItem);\n        }\n    };\n\n    MarkerLayer.prototype._markerClick = function _markerClick (e) {\n        var layers = this.map.layers || [];\n        var marker = e.target._kendoNode;\n\n        var args = {\n            // marker: $(e.target).data('kendoMarker'),\n            // marker: e.target.getAttribute(\"data-kendoMarker\"),\n            layer: this,\n            layerIndex: layers.indexOf(this),\n            marker: marker,\n            markerIndex: (this.items || []).indexOf(marker),\n            originalEvent: e\n        };\n\n        this.map.trigger('markerClick', args);\n    };\n\n    MarkerLayer.prototype._markerMouseEnter = function _markerMouseEnter (e) {\n        var args = this._createMarkerEventArgs(e);\n        this.map.trigger(\"markerMouseEnter\", args);\n    };\n\n    MarkerLayer.prototype._markerMouseLeave = function _markerMouseLeave (e) {\n        var args = this._createMarkerEventArgs(e);\n        this.map.trigger(\"markerMouseLeave\", args);\n    };\n\n    MarkerLayer.prototype._createMarkerEventArgs = function _createMarkerEventArgs (e) {\n        var marker = e.marker;\n\n        var args = extend({}, {\n            layer: this,\n            layerIndex: this.map.layers.indexOf(this),\n            marker: marker,\n            markerIndex: (this.items || []).indexOf(marker)\n        }, e);\n\n        return args;\n    };\n\n    return MarkerLayer;\n}(Layer));\n\nsetDefaultOptions(MarkerLayer, {\n    zIndex: 1000,\n    autoBind: true,\n    locationField: 'location',\n    titleField: 'title'\n});\n\nexport var Marker = (function (Class) {\n    function Marker(options) {\n        Class.call(this);\n        this.options = options || {};\n    }\n\n    if ( Class ) Marker.__proto__ = Class;\n    Marker.prototype = Object.create( Class && Class.prototype );\n    Marker.prototype.constructor = Marker;\n\n    Marker.prototype.destroy = function destroy () {\n        this.layer = null;\n        this.unbindEvents();\n        this.hide();\n    };\n\n    Marker.prototype.addTo = function addTo (parent) {\n        this.layer = parent.markers || parent;\n        this.layer.items.push(this);\n        this.layer.update(this);\n    };\n\n    Marker.prototype.location = function location (value) {\n        if (value) {\n            this.options.location = Location.create(value).toArray();\n\n            if (this.layer) {\n                this.layer.update(this);\n            }\n\n            return this;\n        }\n\n        return Location.create(this.options.location);\n    };\n\n    Marker.prototype.showAt = function showAt (point) {\n        this.render();\n\n        this.element.style.left = toPixels(Math.round(point.x));\n        this.element.style.top = toPixels(Math.round(point.y));\n\n        if (this.tooltip && this.tooltip.popup) {\n            this.tooltip.popup._position();\n        }\n    };\n\n    Marker.prototype.hide = function hide () {\n        if (this.element) {\n            this.element.remove();\n            this.element = null;\n        }\n        if (this.tooltip) {\n            this.tooltip.destroy();\n            this.tooltip = null;\n        }\n    };\n\n    Marker.prototype.bindEvents = function bindEvents () {\n        if (!this.element) {\n            return;\n        }\n\n        this._mouseEnterHandler = proxy(this._mouseEnter, this);\n        on(this.element, MOUSE_ENTER, MARKER_CLASS, this._mouseEnterHandler);\n        this._mouseLeaveHandler = proxy(this._mouseLeave, this);\n        on(this.element, MOUSE_LEAVE, MARKER_CLASS, this._mouseLeaveHandler);\n    };\n\n    Marker.prototype.unbindEvents = function unbindEvents () {\n        if (!this.element) {\n            return;\n        }\n\n        off(this.element, MOUSE_ENTER, this._mouseEnterHandler);\n        off(this.element, MOUSE_LEAVE, this._mouseLeaveHandler);\n    };\n\n    Marker.prototype.render = function render () {\n        if (!this.element) {\n            var options = this.options;\n            var layer = this.layer;\n\n            var element = document.createElement('span');\n            addClass(element, 'k-marker k-icon k-i-marker-' + toHyphens(options.shape || 'pin'));\n\n            element.setAttribute(\"title\", options.title);\n\n            var attributes = options.attributes || {};\n            Object.keys(attributes).forEach(function(key) {\n                element.setAttributett(key, attributes[key]);\n            });\n\n            element._kendoNode = this;\n            element.style.zIndex = options.zIndex;\n\n            this.element = element;\n\n            if (layer) {\n                layer.element.appendChild(this.element);\n            }\n\n            this.bindEvents();\n\n            this.renderTooltip();\n        }\n    };\n\n    Marker.prototype._mouseEnter = function _mouseEnter (e) {\n        var args = this._createEventArgs(e);\n        this.layer._markerMouseEnter(args);\n    };\n\n    Marker.prototype._mouseLeave = function _mouseLeave (e) {\n        var args = this._createEventArgs(e);\n        this.layer._markerMouseLeave(args);\n    };\n\n    Marker.prototype._createEventArgs = function _createEventArgs (e) {\n        var args = {\n            marker: this,\n            originalEvent: e\n        };\n\n        return args;\n    };\n\n    Marker.prototype.renderTooltip = function renderTooltip () {\n    };\n\n    Marker.create = function create (arg, defaults) {\n        if (arg instanceof Marker) {\n            return arg;\n        }\n\n        return new Marker(deepExtend({}, defaults, arg));\n    };\n\n    return Marker;\n}(Class));\n"]},"metadata":{},"sourceType":"module"}